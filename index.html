<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>æˆ‘çš„å°æ‰‹æœº</title>
  <link rel="stylesheet" href="./styles.css" />
  <style>
    /* å¼ºåŠ›ä¿®å¤ä½ç½®é”™ä½ */
    .grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      padding: 20px;
      justify-items: center; /* æ°´å¹³å±…ä¸­ */
    }
    .app {
      display: flex;
      flex-direction: column;
      align-items: center; /* å‚ç›´å±…ä¸­ */
      text-decoration: none;
      color: #333;
      width: 70px;
    }
    .icon-wrapper {
      width: 60px;
      height: 60px;
      border-radius: 15px;
      overflow: hidden;
      background: #f0f0f0;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .icon-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .app-label {
      font-size: 11px;
      margin-top: 5px;
      text-align: center;
    }

    /* è®¾ç½®å¼¹çª—ä¼˜åŒ– */
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 9999; align-items: flex-end; }
    .modal.active { display: flex; }
    .modal-content {Â 
      width: 100%; background: rgba(255,255,255,0.9); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
      border-radius: 30px 30px 0 0; padding: 20px; box-sizing: border-box; transform: translateY(100%); transition: 0.3s;
    }
    .modal.active .modal-content { transform: translateY(0); }
    .s-item { background: white; border-radius: 12px; padding: 10px 15px; margin: 8px 0; display: flex; justify-content: space-between; align-items: center; font-size: 14px; }
  </style>
</head>
<body>
 Â 
  <div class="phone-container">
    <div class="screen">
     Â 
      <div class="top-card">
        <div class="name">çŒ«çŒ«</div>
        <div class="mood-box">ä»Šå¤©å¿ƒæƒ…ï¼šğŸ©·</div>
      </div>

      <div class="grid">
        <div class="widget-weather" onclick="openSettings()">
          <img src="./weather-icon.png" id="img-weather" alt="weather" onerror="this.src='https://cdn-icons-png.flaticon.com/512/3222/3222800.png'">
          <div class="widget-info"><div class="location">é’ç§€åŒº ğŸ”</div><div class="temp">14Â°</div><div class="condition">å¤§é›¾</div></div>
        </div>

        <a class="app" href="wechat.html">
          <div class="icon-wrapper"><img src="./wechat.png" id="main-wechat" alt="å¾®ä¿¡"></div>
          <div class="app-label">å¾®ä¿¡</div>
        </a>
        <div class="app">
          <div class="icon-wrapper"><img src="./health.png" id="main-health" alt="çŠ¶æ€"></div>
          <div class="app-label">çŠ¶æ€</div>
        </div>
        <div class="app">
          <div class="icon-wrapper"><img src="./music.png" id="main-music" alt="å¬æ­Œ"></div>
          <div class="app-label">ä¸€èµ·å¬æ­Œ</div>
        </div>
        <div class="app">
          <div class="icon-wrapper"><img src="./books.png" id="main-books" alt="çœ‹ä¹¦"></div>
          <div class="app-label">ä¸€èµ·çœ‹ä¹¦</div>
        </div>
        <div class="app">
          <div class="icon-wrapper"><img src="./home.png" id="main-home" alt="å®¶å›­"></div>
          <div class="app-label">å®¶å›­</div>
        </div>
        <div class="app">
          <div class="icon-wrapper"><img src="./reminders.png" id="main-reminders" alt="æé†’"></div>
          <div class="app-label">æé†’</div>
        </div>
      </div>

      <div class="dock">
        <div class="dock-content">
          <a class="dock-item" href="wechat.html">
            <div class="icon-wrapper"><img src="./wechat.png" id="dock-wechat"></div>
          </a>
          <div class="dock-item"><div class="icon-wrapper"><img src="./phone.png" id="dock-phone"></div></div>
          <div class="dock-item"><div class="icon-wrapper"><img src="./camera.png" id="dock-camera"></div></div>
          <div class="dock-item" onclick="openSettings()">
            <div class="icon-wrapper"><img src="./settings.png" id="dock-settings"></div>
          </div>
        </div>
      </div>

    </div>Â 
  </div>

  <div id="settings-modal" class="modal" onclick="if(event.target==this) closeSettings()">
    <div class="modal-content">
      <h4 style="text-align:center; margin-top:0;">ä¸ªæ€§åŒ–è®¾ç½®</h4>
     Â 
      <div class="s-item">
        <span>API åœ°å€ (Vercel)</span>
        <input type="text" id="api-url" placeholder="https://..." style="border:none; text-align:right; width:60%;">
      </div>

      <div class="s-item">
        <span>æ›´æ¢å›¾æ ‡</span>
        <select id="app-selector">
          <option value="wechat">å¾®ä¿¡</option>
          <option value="health">çŠ¶æ€</option>
          <option value="music">å¬æ­Œ</option>
          <option value="books">çœ‹ä¹¦</option>
          <option value="home">å®¶å›­</option>
          <option value="reminders">æé†’</option>
          <option value="phone">ç”µè¯(Dock)</option>
          <option value="camera">ç›¸æœº(Dock)</option>
        </select>
        <input type="file" id="icon-upload" accept="image/*" style="width:80px;">
      </div>

      <button onclick="saveAndClose()" style="width:100%; padding:15px; border-radius:15px; border:none; background:#007AFF; color:white; font-size:16px; margin-top:10px;">å®Œæˆ</button>
    </div>
  </div>

  <script>
    function openSettings() { document.getElementById('settings-modal').classList.add('active'); }
    function closeSettings() { document.getElementById('settings-modal').classList.remove('active'); }

    async function saveAndClose() {
      const appType = document.getElementById('app-selector').value;
      const file = document.getElementById('icon-upload').files[0];
      const apiUrl = document.getElementById('api-url').value;

      if (apiUrl) localStorage.setItem('vercel-api-url', apiUrl);

      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const b64 = e.target.result;
          localStorage.setItem('icon-' + appType, b64);
          // åŒæ­¥æ›´æ–°ä¸»å±å¹•å’Œ Dock æ ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
          if(document.getElementById('main-' + appType)) document.getElementById('main-' + appType).src = b64;
          if(document.getElementById('dock-' + appType)) document.getElementById('dock-' + appType).src = b64;
        };
        reader.readAsDataURL(file);
      }
      closeSettings();
    }

    // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨å›æ˜¾å›¾ç‰‡
    window.onload = function() {
      const apps = ['wechat', 'health', 'music', 'books', 'home', 'reminders', 'phone', 'camera', 'settings'];
      apps.forEach(app => {
        const saved = localStorage.getItem('icon-' + app);
        if(saved) {
          if(document.getElementById('main-' + app)) document.getElementById('main-' + app).src = saved;
          if(document.getElementById('dock-' + app)) document.getElementById('dock-' + app).src = saved;
        }
      });
    };
  </script>
</body>
</html>
